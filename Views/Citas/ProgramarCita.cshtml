@using SistemaVeterinaria.Models
 
@{
    ViewBag.Title = "Programar Cita";
}

<h2>Programar Cita</h2>

<form asp-action="ProgramarCita" method="post">
    <div class="form-group">
        <label for="Descripcion">Descripción de la Consulta</label>
        <input type="text" class="form-control" id="Descripcion" name="Descripcion" placeholder="Ingrese la descripción de la consulta" required />
    </div>

    <div class="form-group">
        <label for="Fecha">Fecha y Hora</label>
        <input type="datetime-local" class="form-control" id="Fecha" name="Fecha" required />
    </div>

    <div class="form-group">
        <label for="tipoCita">Tipo de Cita</label>
        <select class="form-control" id="tipoCita" name="tipoCita" required>
            <option value="Consulta">Consulta General</option>
            <option value="Vacunacion">Vacunación</option>
        </select>
    </div>

    <div class="form-group">
        <label for="Animal">Selecciona un Animal</label>
        <select class="form-control" id="Animal" name="animalId" onchange="mostrarInformacionCliente()" required>
            <option value="">Selecciona un Animal</option>
            @foreach (var animal in ViewBag.Animales as List<Animal>)
            {
                <option value="@animal.Id">@animal.Especie</option>
            }
        </select>
    </div>

    <div id="informacionCliente">
        
    </div>

    <button type="submit" class="btn btn-primary">Programar Cita</button>
</form>

<script>
    function mostrarInformacionCliente() {
        var animalId = document.getElementById("Animal").value;
        if (animalId) {
            //  para obtener la información del cliente asociado al animal
            $.ajax({
                url: '@Url.Action("ObtenerInformacionCliente", "Citas")',
                type: 'GET',
                data: { animalId: animalId },
                success: function (data) {
                    $('#informacionCliente').html(data);
                },
                error: function () {
                    $('#informacionCliente').html('<p>Error al obtener información del cliente.</p>');
                }
            });
        } else {
            $('#informacionCliente').html('');
        }
    }
</script>
